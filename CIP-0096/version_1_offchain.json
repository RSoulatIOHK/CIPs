{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "subject": {
      "type": "string",
      "description": "Can be anything. Subject of the certification. It should match the registration metadata subject and the on-chain metadata."
    },
    "schemaVersion": {
      "type": "integer",
      "description": "Used to describe the json schema version of the off-chain metadata."

    },
    "certificationLevel": {
      "type": "integer",
      "enum": [0,1,2,3],
      "description": "Describes the action this certification certificate is claiming. For the moment, CERTIFY shall be used to claim a certification that meets the Certfication Standard. AUDIT shall be used to publish on-chain an audit that may not meet the Certification standard. Shall match the on-chain certificationLevel."
    },
    "certificateIssuer": {
      "type": "object",
      "properties": {
        "name": {
           "type": "string",
           "description": "Name of the Certificate Issuer."
        },
        "logo": {
            "type": "string",
            "description": "URL to the logo of the Certificate Issuer."
            "pattern": "^(https?:\/\/(?:www\\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|https?:\/\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})\\.(?:jpg|jpeg|png|gif|bmp|svg|webp|tiff|tif)$"
        },
        "social": {
          "type": "object",
          "properties": {
            "twitter": {
              "type": "string",
              "description": "Twitter handle of the Certificate Issuer.",
              "pattern": "@\\w{1,15}"
            },
            "github": {
              "type": "string",
              "description": "GitHub handle of the Certificate Issuer.",
              "pattern": "^(?:https?:\/\/)?(?:www\\.)?github\\.com\/[\\w-]+\/[\\w.-]+$"
            },
            "contact": {
              "type": "string",
              "description": "Contact email of the Certification Issuer.",
              "pattern" : "^\\S+@\\S+\\.\\S+$"
            },
            "website": {
              "type": "string",
              "description": "URL to the website of the Certificate Issuer.",
              "pattern": "^(https?:\/\/(?:www\\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|https?:\/\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$"
            },
            "discord": {
                "type": "string",
                "description": "URL to the Discord server of the Certificate Issuer.",
                "pattern": "^(?:https?:\/\/)?discord(?:\\.gg|app\\.com\/invite|\\.com\/invite)\/[\\w-]+$"
            }
          },
          "description": "Social contacts of the Certificate Issuer.",
          "required": [
              "website",
              "contact"
          ]
        }
      },
      "required": [
          "name",
          "social"
      ]
    },
    "report": {
      "type": "object",
      "properties": {
        "reportURLs": {
          "type": "array",
          "items": [
              {
                "type": "string",
                "description": "A URL to the report of the certification/audit.",
                "^(https?:\/\/(?:www\\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|https?:\/\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})\\.(?:json|pdf)$"
              }
          ]
        },
        "reportHash": {
          "type": "string",
          "description": "Hash of the report pointed by the links in reportURLs.",
          "pattern": "^[a-fA-F0-9]{64}$"
        }
      },
      "required": [
          "reportURLs",
          "reportHash"
      ]
    },
    "summary": {
      "type": "string",
      "description": "A string of the summary of the certification/audit."
    },
    "disclaimer": {
      "type": "string",
      "description": "A string of the legal disclaimer from the Certificate Issuer."
    },
    "scripts": {
      "type": "array",
      "items": [
        {
            "smartContractInfo": {
                "type": "object",
                "properties": {
                    "era": {
                        "type": "string",
                        "description": "Describe which era this script was written for."

                    },
                    "compiler": {
                        "type": "string",
                        "description": "Compiler used for this script."
                    },
                    "compilerVersion": {
                        "type": "string",
                        "description": "Compiler version used for this script."
                    },
                    "optimizer": {
                        "type": "string",
                        "description": "Post compilation optimizer used for this script."
                    },
                    "optimizerVersion": {
                        "type": "string",
                        "description": "Post compilation optimizer version used for this script."
                    },
                    "progLang": {
                        "type": "string",
                        "description": "Programming language used for this script."
                    },
                    "repository": {
                        "type": "string",
                        "description": "URL to the repository of the script."
                    }
                }
            },
            "scriptHash": {
              "type": "string",
              "description": "Script hash or script hash+staking key."
            },
            "contractAddress": {
              "type": "string",
              "description": "Script on-chain address.h"
            },
            "required": [
                "scriptHash"
              ]
        }
      ]
    }
  },

  "required": [
    "subject",
    "schemaVersion",
    "certificationLevel",
    "certificateIssuer",
    "report",
    "summary",
    "disclaimer",
    "scripts"
  ]
}